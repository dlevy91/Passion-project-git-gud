@model gitgudclone.Data.ApplicationDbContext

@* TODO - Update list to iterate backwards so new messages appear first *@

<h1>Unread Messages</h1>
<table class="table table-dark">
  <thead>
    <tr>
      <th scope="col">Status</th>
      <th scope="col">Time</th>
      <th scope="col">From</th>
      <th scope="col">Subject</th>
    </tr>
  </thead>
    <tbody>
      @foreach (MessagesModel message in @Model.messagesList)
      {
        @if(message.recipientEmail == User.Identity.Name)
        {
          <tr>
            @if(message.isRead == false)
            {
              <th scope="row">
              @if(@message.isRead == false)
              {
                <span>Unread</span>
              }
              else{
                <span>Read</span>
              }
              </th>

              <td><a asp-area="" asp-controller="gitgud" asp-action="viewmessagedetails" asp-route-messageID = "@message.id">@message.messageDate</a></td>

              <td><a asp-area="" asp-controller="gitgud" asp-action="viewmessagedetails" asp-route-messageID = "@message.id">@message.userEmail</a></td>

              <td><a asp-area="" asp-controller="gitgud" asp-action="viewmessagedetails" asp-route-messageID = "@message.id">@message.subjectLine</a></td>
              }
          </tr>
        }
      }
    </tbody>
</table>    
@* =================================================================================================================== *@

<h1>Read Messages</h1>
<table class="table table-dark">
  <thead>
    <tr>
      <th scope="col">Status</th>
      <th scope="col">Time</th>
      <th scope="col">From</th>
      <th scope="col">Subject</th>
  </thead>
    <tbody>
      @foreach (MessagesModel message in @Model.messagesList)
      {
        @if(message.recipientEmail == User.Identity.Name)
        {
          <tr>
            @if(message.isRead == true)
            {
              <th scope="row">
              @if(@message.isRead == false)
              {
                <span>Unread</span>
              }
              else{
                <span>Read</span>
              }
              </th>

              <td><a asp-area="" asp-controller="gitgud" asp-action="viewmessagedetails" asp-route-messageID = "@message.id">@message.messageDate</a></td>

              <td><a asp-area="" asp-controller="gitgud" asp-action="viewmessagedetails" asp-route-messageID = "@message.id">@message.userEmail</a></td>

              <td><a asp-area="" asp-controller="gitgud" asp-action="viewmessagedetails" asp-route-messageID = "@message.id">@message.subjectLine</a></td>
              }
          </tr>
        }
      }
    </tbody>
</table>    